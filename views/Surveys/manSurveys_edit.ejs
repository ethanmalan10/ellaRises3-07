<!-- Manager Surveys Edit - modify an existing survey -->
<section class="main-content" style="max-width: 720px; margin: 0 auto;">
  <div class="card" style="padding: 28px; border-radius: 18px;">
    <h2 style="margin:0 0 12px 0; font-family: var(--font-serif);">Edit Survey</h2>
    <% const displayName = (survey.participantName && survey.participantName.trim().length)
      ? survey.participantName
      : ((survey.userName && survey.userName.trim().length)
          ? survey.userName
          : ((survey.userEmail && survey.userEmail.trim().length)
              ? survey.userEmail
              : 'Unknown participant')); %>

    <p style="margin:0 0 20px 0; color:var(--charcoal); opacity:0.8;">
      Update details below and save.
    </p>

    <form method="POST" action="/admin/surveys/<%= survey.id %>/edit" style="display:grid; gap:14px;">
      <div>
        <label for="participantId" style="font-weight:600; display:block; margin-bottom:.35rem;">Participant</label>
        <select id="participantId" name="participantId" required style="width:100%; padding:12px; border-radius:10px;">
          <% (participants || []).forEach(p => { %>
            <option value="<%= p.id %>" <%= Number(p.id) === Number(survey.participantid) ? 'selected' : '' %>><%= p.label %></option>
          <% }) %>
        </select>
      </div>

      <div>
        <label for="eventoccurrenceid" style="font-weight:600; display:block; margin-bottom:.35rem;">Event</label>
        <select id="eventoccurrenceid" name="eventoccurrenceid" required style="width:100%; padding:12px; border-radius:10px;">
          <% (events || []).forEach(ev => { %>
            <option value="<%= ev.id %>" <%= Number(ev.id) === Number(survey.eventoccurrenceid) ? 'selected' : '' %>><%= ev.label %></option>
          <% }) %>
        </select>
      </div>

      <div>
        <label for="satisfaction" style="font-weight:600; display:block; margin-bottom:.35rem;">Satisfaction (1-5)</label>
        <% const satVal = Number(survey.satisfaction); %>
        <select id="satisfaction" name="satisfaction" required style="width:100%; padding:12px; border-radius:10px;">
          <% for (let i = 1; i <= 5; i++) { %>
            <option value="<%= i %>" <%= satVal === i ? 'selected' : '' %>><%= i %></option>
          <% } %>
        </select>
      </div>

      <div>
        <label for="usefulness" style="font-weight:600; display:block; margin-bottom:.35rem;">Usefulness (1-5)</label>
        <% const useVal = Number(survey.usefulness); %>
        <select id="usefulness" name="usefulness" required style="width:100%; padding:12px; border-radius:10px;">
          <% for (let i = 1; i <= 5; i++) { %>
            <option value="<%= i %>" <%= useVal === i ? 'selected' : '' %>><%= i %></option>
          <% } %>
        </select>
      </div>

      <div>
        <label for="instructor" style="font-weight:600; display:block; margin-bottom:.35rem;">Instructor (1-5)</label>
        <% const instVal = Number(survey.instructor); %>
        <select id="instructor" name="instructor" required style="width:100%; padding:12px; border-radius:10px;">
          <% for (let i = 1; i <= 5; i++) { %>
            <option value="<%= i %>" <%= instVal === i ? 'selected' : '' %>><%= i %></option>
          <% } %>
        </select>
      </div>

      <div>
        <label for="recommendation" style="font-weight:600; display:block; margin-bottom:.35rem;">Recommend (1-5)</label>
        <% const recVal = Number(survey.recommendation); %>
        <select id="recommendation" name="recommendation" required style="width:100%; padding:12px; border-radius:10px;">
          <% for (let i = 1; i <= 5; i++) { %>
            <option value="<%= i %>" <%= recVal === i ? 'selected' : '' %>><%= i %></option>
          <% } %>
        </select>
      </div>

      <div>
        <label for="comments" style="font-weight:600; display:block; margin-bottom:.35rem;">Comments</label>
        <textarea
          id="comments"
          name="comments"
          rows="4"
          style="width:100%; padding:12px; border-radius:10px;"
        ><%= survey.comments || '' %></textarea>
      </div>

      <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <button type="submit" class="btn-login-home" style="padding:12px 18px; border-radius:10px;">Save</button>
        <a href="/admin/surveys" class="btn-login-home" style="padding:12px 18px; border-radius:10px; background:#f0f0f0; color:var(--charcoal);">Cancel</a>
      </div>
    </form>
  </div>
</section>
