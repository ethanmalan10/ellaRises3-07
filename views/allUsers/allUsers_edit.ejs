<main class="container main-content" style="max-width:780px; margin-top:2.5rem;">
  <header style="display:flex; justify-content:space-between; align-items:center; gap:1rem; flex-wrap:wrap; margin-bottom:1rem;">
    <div>
      <h1 style="margin:0; font-family:var(--font-serif); color:var(--charcoal);">Edit User</h1>
      <p class="muted" style="margin:.3rem 0 0 0;">Update username, password, role, or linked participant.</p>
    </div>
    <a class="btn-cream" href="/admin/users" style="padding:10px 14px; border-radius:10px; text-decoration:none;">Back to Users</a>
  </header>

  <% if (error) { %>
    <div class="alert alert-danger"><%= error %></div>
  <% } %>

  <form method="POST" action="/admin/users/<%= user ? user.userid : '' %>/edit" class="card" style="padding:16px; border-radius:12px; border:1px solid #e5e7eb;">
    <div class="form-group">
      <label for="username">Username (email)</label>
      <input type="text" id="username" name="username" class="form-control" required value="<%= (user && user.username) || '' %>">
    </div>
    <div class="form-group">
      <label for="password">Password (leave blank to keep current)</label>
      <input type="password" id="password" name="password" class="form-control">
    </div>
    <div class="form-group">
      <label>Role / Level</label>
      <div style="display:flex; gap:12px; flex-wrap:wrap;">
        <label><input type="radio" name="level" value="m" <%= (user && user.level === 'm') ? 'checked' : '' %>> Manager</label>
        <label><input type="radio" name="level" value="u" <%= (!user || user.level === 'u') ? 'checked' : '' %>> User</label>
      </div>
    </div>
    <div class="form-group">
      <label for="participantid">Link to Participant (optional)</label>
      <input type="number" id="participantid" name="participantid" class="form-control" placeholder="Participant ID" value="<%= (user && user.participantid) || '' %>">
      <small class="muted">Leave blank to keep unlinked.</small>
    </div>
    <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;">
      <button type="submit" class="btn-gradient" style="padding:10px 14px; border-radius:10px;">Save Changes</button>
      <a href="/admin/users" class="btn-cream" style="padding:10px 14px; border-radius:10px; text-decoration:none;">Cancel</a>
    </div>
  </form>
</main>
